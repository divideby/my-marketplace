---
description: Подобрать рецепт по имеющимся продуктам с учётом предпочтений
allowed-tools:
  - Read
  - Glob
  - Grep
  - AskUserQuestion
---

# Подбор рецепта

## Задача

Подобрать рецепт из базы Obsidian на основе продуктов в холодильнике и предпочтений пользователя.

## Настройки

Прочитай настройки из `.claude/recipes.local.md` в текущем проекте:

```yaml
---
vault_path: ~/Yandex.Disk/Ocean/new-ocean/Base
favorites:
  - курица
  - паста
  - чеснок
dislikes:
  - кинза
  - острое
dietary: []  # без глютена, вегетарианское, и т.д.
---
```

Если файла нет — используй `vault_path` по умолчанию и спроси о предпочтениях.

## Процесс

1. **Спроси пользователя**: "Что есть в холодильнике? Перечисли основные продукты."

2. **Найди все рецепты** в vault_path:
   - Используй Glob для поиска файлов `Рецепт - *.md`
   - Или Grep для поиска файлов с `tags: recipe` или `- recipe` в frontmatter

3. **Прочитай рецепты** и извлеки:
   - Название
   - Список ингредиентов из frontmatter
   - Категорию (если есть)

4. **Отфильтруй по критериям**:
   - Исключи рецепты с продуктами из `dislikes`
   - Исключи рецепты, не соответствующие `dietary`
   - Приоритизируй рецепты с продуктами из `favorites`

5. **Ранжируй по совпадению**:
   - Подсчитай сколько ингредиентов есть у пользователя
   - Подсчитай сколько нужно докупить
   - Сортируй по % совпадения

6. **Предложи 1-3 лучших варианта**:

```
## Рекомендации

### 1. Паста с курицей и чесноком ⭐
Совпадение: 80% (4 из 5 ингредиентов)
Нужно докупить: пармезан

### 2. Куриный суп
Совпадение: 60% (3 из 5 ингредиентов)
Нужно докупить: морковь, сельдерей
```

7. **Спроси**: "Какой рецепт показать подробнее?"

8. **Покажи полный рецепт** по выбору пользователя.

## Если рецептов нет

Если в базе нет рецептов с тегом `recipe`:
- Сообщи пользователю
- Предложи добавить рецепты через `/recipes:new`
